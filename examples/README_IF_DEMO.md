# IF条件节点演示说明

## 功能概述

IF条件节点是CopilotNode RPA工具的高级功能，可以根据条件执行不同的动作分支，使自动化流程更加智能和灵活。

## 支持的条件类型

### 1. 图像存在检查 (image_exists)
- 检查屏幕上是否存在指定的图像
- 支持自定义匹配阈值 (0.1-1.0)
- 常用于界面状态检查、按钮是否出现等场景

### 2. 节点结果检查 (node_result)  
- 基于其他节点的执行结果进行判断
- 可以检查节点执行成功/失败状态
- 适用于复杂的条件逻辑组合

## 工作原理

1. **条件评估**: IF节点执行时会根据配置的条件类型进行检查
2. **分支选择**: 根据条件结果选择执行路径
   - 条件为真 → 执行 `true_connections` 中的节点
   - 条件为假 → 执行 `false_connections` 中的节点
3. **流程继续**: 分支执行完毕后，流程根据连接继续进行

## 使用步骤

### 1. 创建IF节点
1. 在画布上右键点击
2. 选择 "🔀 添加IF条件"
3. 配置条件类型和参数

### 2. 图像存在条件配置
- **条件类型**: 选择 "图像存在"
- **目标图像**: 选择要检测的图像文件（PNG/JPG等）
- **匹配阈值**: 设置图像匹配的精确度（建议0.8）

### 3. 节点结果条件配置  
- **条件类型**: 选择 "节点结果"
- **目标节点ID**: 输入要检查的节点ID
- **期望结果**: 选择期望的结果（成功/失败）

## 示例场景

### 场景1: 智能点击
```
开始 → IF(按钮图像存在) → 真:点击按钮 → 成功提示
                    ↓
                   假:等待重试 → 重试提示
```

### 场景2: 错误处理
```
执行动作 → IF(错误图标存在) → 真:处理错误 → 恢复操作
                         ↓
                        假:继续正常流程
```

## 注意事项

1. **图像文件**: 确保用于检测的图像文件清晰、特征明显
2. **阈值调整**: 根据实际情况调整匹配阈值，过高可能匹配失败，过低可能误匹配
3. **分支连接**: IF节点需要手动设置分支连接（未来版本将支持可视化连线）
4. **执行顺序**: 当前版本按节点顺序执行，未来将支持复杂的连线逻辑

## 演示项目

`if_demo_project.json` 包含了一个完整的IF条件演示：
- 检查目标图像是否存在
- 存在则点击图像并显示成功消息
- 不存在则等待并显示重试消息

## 高级用法

### 1. 多条件组合
可以通过多个IF节点实现复杂的条件判断：
```
IF(条件1) → 真:IF(条件2) → 真:动作A
                       → 假:动作B
        → 假:动作C
```

### 2. 循环检查
结合等待节点实现循环检查：
```
等待 → IF(条件) → 真:执行动作
              → 假:返回等待 (手动设置连接)
```

## 故障排除

1. **IF节点不工作**: 检查条件配置是否正确
2. **图像检测失败**: 确认图像文件路径和阈值设置
3. **分支不执行**: 检查true_connections和false_connections配置
4. **流程停止**: 确保分支节点有正确的后续连接

## 技术实现

IF节点基于以下技术实现：
- **图像识别**: OpenCV模板匹配
- **流程控制**: 自定义执行引擎支持分支逻辑
- **上下文管理**: 执行上下文存储节点间状态信息